<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>USAT CALCULATOR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="assets/img/usat_logo_red.jpg" type="image">
    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- SweetAlert2 CDN -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- PDF.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI&display=swap" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="manifest" href="manifest.webmanifest">
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('service-worker.js');
            });
        }
    </script>
    <script>
        // Theme toggle logic
        function setTheme(theme) {
            if (theme === 'auto') {
                document.body.removeAttribute('data-theme');
                sessionStorage.setItem('theme', 'auto');
            } else {
                document.body.setAttribute('data-theme', theme);
                sessionStorage.setItem('theme', theme);
            }
        }

        function getSystemTheme() {
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        function applyThemeOnLoad() {
            let theme = sessionStorage.getItem('theme') || 'auto';
            if (theme === 'auto') {
                // Detecta el tema del sistema y lo aplica visualmente
                const systemTheme = getSystemTheme();
                document.body.setAttribute('data-theme', systemTheme);
            } else {
                document.body.setAttribute('data-theme', theme);
            }
            // Actualiza el select visualmente
            var select = document.getElementById('theme-select');
            if (select) select.value = theme;
        }

        // Escucha cambios en el sistema y actualiza si est√° en auto
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function() {
            if ((sessionStorage.getItem('theme') || 'auto') === 'auto') {
                applyThemeOnLoad();
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            applyThemeOnLoad();
            // Toggle event
            $(document).on('change', '#theme-select', function () {
                setTheme(this.value);
                applyThemeOnLoad();
            });
        });
    </script>
</head>

<body>

    <div class="container py-5">
        <h2 class="text-center mb-4">
            <img src="assets/img/usat_logo.png" alt="logo" style="width: 90px;">
            GENERADOR DE CALCULADORA DE PROMEDIO</h2>

        <div class="card p-4 shadow-lg bg-light text-dark">
            <label for="pdfFile" class="form-label">Sube tu silabo del curso</label>
            <input type="file" class="form-control mb-3" id="pdfFile" accept="application/pdf">

            <button class="btn btn-danger w-100" onclick="analizarPDF()">
                <i class="bi bi-file-earmark-text"></i> Generar Calculadora
        </div>
    </div>

    <div class="container" id="body-content">

    </div>

    <div class="theme-toggle">
        <label for="theme-select" class="me-1 mb-0"><i class="bi bi-moon-stars"></i></label>
        <select id="theme-select" class="form-select form-select-sm"
            style="width: auto; display: inline-block;">
            <option value="auto">Auto</option>
            <option value="light">Claro</option>
            <option value="dark">Oscuro</option>
        </select>
    </div>

    <script src="js/app.js"></script>

</body>

</html>